#summary Configuring wkhtmltopdf on Linux
#labels Phase-Deploy

= Introduction =

These are just some quick notes on setting up *wkhtmltopdf* on our CentOS Linux servers. As we gain expertise, I'm sure we'll iron out the details a bit better.


= Details =

  * Download wkhtmltopdf-0.11.0_rc1-static-i386.tar.bz2 from [http://code.google.com/p/wkhtmltopdf/ wkhtmltopdf on Google Code].

  * Unzip using bunzip2, or perhaps use 
    {{{tar xvjf wkhtmltopdf-0.11.0_rc1-static-i386.tar.bz2}}}

  * Install dependencies via yum:
    {{{yum install fontconfig libXrender libXext '*fonts*' openssl}}}

    {{{yum remove tetex-fonts}}}      (not needed and generates daily cron errors)
    
    (In particular you want urw-fonts, but you probably want others too, like xorg-x11-fonts-truetype if available)

  * Either put the file `wkhtmltopdf-i386` into your `~/bin` directory named `wkhtmltopdf` or create softlink, such as `cd ~bin` and `ln -s ../wkhtmltopdf_0.11.0/wkhtmltopdf-i386 wkhtmltopdf`.

  * For our HTML, we typically use options:
    {{{wkhtmltopdf --page-size Letter --print-media-type --image-quality 100}}}

    Try running the command `wkhtmltopdf` to ensure it can be found in your PATH and that it shows no missing components.

  * For the 32-bit static builds, assuming you are on 64-bit Linux, you'll want to make sure you have these components with i386/i686 architecture. If you have the 64-bit versions, you can use `yum whatprovides fontconfig` to discover the component details for the 32-bit version (in this case, fontconfig-2.4.1-7.el5.i386 or fontconfig-2.8.0-3.el6.i686).  This includes `fontconfig`, `libXrender`, `openssl`, `libzip`, `libXext` and `libstdc++`.

= Questionable =

In our various installs, we also did yum installs of:
  * libX11-devel
  * giflib
  * libpng
  * libjpeg
  * a2ps (pretty sure not needed)
  * libstdc++ (required on some x64 Linux if the i386/i686 version is not present for 32-bit)
  * zlib, libzip may also be needed on x64 Linux to get the i386/i686 versions

Often these did not resolve issues, but unsure if they are helpful or not.

= Windows Developers =

There is generally a Windows installer version for this program that can be used on Windows platforms. Our developers typically are on Windows, and so they make use of the Windows version if they need the PDF export capability.  

We downloaded 'wkhtmltox-0.11.0_rc1-installer.exe' and when run, it installed the tool in {{{C:\Program Files (x86)\wkhtmltopdf}}}

For Tomcat+Java on Windows 7, we found we had to add that path to Windows PATH. For Windows 7, we did this by clicking on the Windows icon, Right-click on Computer->Properties, click on Advanced system settings, click on Environment Variables button, under System variables scroll and click on Path, click the Edit button, then append at the end: {{{;C:\Program Files (x86)\wkhtmltopdf}}}